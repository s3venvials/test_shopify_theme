"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.printLiquidBranch = exports.printLiquidTag = exports.printLiquidBlockEnd = exports.printLiquidBlockStart = exports.printLiquidDrop = void 0;
const prettier_1 = require("prettier");
const types_1 = require("../../types");
const ast_1 = require("../../parser/ast");
const utils_1 = require("../../utils");
const utils_2 = require("../../printer/utils");
const children_1 = require("../../printer/print/children");
const LIQUID_TAGS_THAT_ALWAYS_BREAK = ['for', 'case'];
const { builders } = prettier_1.doc;
const { group, hardline, ifBreak, indent, join, line, softline } = builders;
function printLiquidDrop(path, _options, print, { leadingSpaceGroupId, trailingSpaceGroupId }) {
    const node = path.getValue();
    const whitespaceStart = (0, utils_2.getWhitespaceTrim)(node.whitespaceStart, (0, utils_2.hasMeaningfulLackOfLeadingWhitespace)(node), leadingSpaceGroupId);
    const whitespaceEnd = (0, utils_2.getWhitespaceTrim)(node.whitespaceEnd, (0, utils_2.hasMeaningfulLackOfTrailingWhitespace)(node), trailingSpaceGroupId);
    if (typeof node.markup !== 'string') {
        const whitespace = node.markup.filters.length > 0 ? line : ' ';
        return group([
            '{{',
            whitespaceStart,
            indent([whitespace, path.call(print, 'markup')]),
            whitespace,
            whitespaceEnd,
            '}}',
        ]);
    }
    const lines = (0, utils_2.markupLines)(node.markup);
    if (lines.length > 1) {
        return group([
            '{{',
            whitespaceStart,
            indent([hardline, join(hardline, lines.map(utils_2.trim))]),
            hardline,
            whitespaceEnd,
            '}}',
        ]);
    }
    return group([
        '{{',
        whitespaceStart,
        ' ',
        node.markup,
        ' ',
        whitespaceEnd,
        '}}',
    ]);
}
exports.printLiquidDrop = printLiquidDrop;
function printLiquidBlockStart(path, leadingSpaceGroupId, trailingSpaceGroupId) {
    const node = path.getValue();
    if (!node.name)
        return '';
    const lines = (0, utils_2.markupLines)(node.markup);
    const whitespaceStart = (0, utils_2.getWhitespaceTrim)(node.whitespaceStart, needsBlockStartLeadingWhitespaceStrippingOnBreak(node), leadingSpaceGroupId);
    const whitespaceEnd = (0, utils_2.getWhitespaceTrim)(node.whitespaceEnd, needsBlockStartTrailingWhitespaceStrippingOnBreak(node), trailingSpaceGroupId);
    if (node.name === 'liquid') {
        return group([
            '{%',
            whitespaceStart,
            ' ',
            node.name,
            indent([hardline, join(hardline, (0, utils_2.reindent)(lines, true))]),
            hardline,
            whitespaceEnd,
            '%}',
        ]);
    }
    if (lines.length > 1) {
        return group([
            '{%',
            whitespaceStart,
            indent([hardline, node.name, ' ', join(hardline, lines.map(utils_2.trim))]),
            hardline,
            whitespaceEnd,
            '%}',
        ]);
    }
    const markup = node.markup;
    return group([
        '{%',
        whitespaceStart,
        ' ',
        node.name,
        markup ? ` ${markup}` : '',
        ' ',
        whitespaceEnd,
        '%}',
    ]);
}
exports.printLiquidBlockStart = printLiquidBlockStart;
function printLiquidBlockEnd(path, leadingSpaceGroupId, trailingSpaceGroupId) {
    var _a, _b;
    const node = path.getValue();
    if (!node.children || !node.blockEndPosition)
        return '';
    const whitespaceStart = (0, utils_2.getWhitespaceTrim)((_a = node.delimiterWhitespaceStart) !== null && _a !== void 0 ? _a : '', needsBlockEndLeadingWhitespaceStrippingOnBreak(node), leadingSpaceGroupId);
    const whitespaceEnd = (0, utils_2.getWhitespaceTrim)((_b = node.delimiterWhitespaceEnd) !== null && _b !== void 0 ? _b : '', (0, utils_2.hasMeaningfulLackOfTrailingWhitespace)(node), trailingSpaceGroupId);
    return group([
        '{%',
        whitespaceStart,
        ` end${node.name} `,
        whitespaceEnd,
        '%}',
    ]);
}
exports.printLiquidBlockEnd = printLiquidBlockEnd;
function printLiquidTag(path, options, print, { leadingSpaceGroupId, trailingSpaceGroupId } = {}) {
    const node = path.getValue();
    if (!node.children || !node.blockEndPosition) {
        return printLiquidBlockStart(path, leadingSpaceGroupId, trailingSpaceGroupId);
    }
    const tagGroupId = Symbol('tag-group');
    const blockStart = printLiquidBlockStart(path, leadingSpaceGroupId, tagGroupId);
    const blockEnd = printLiquidBlockEnd(path, tagGroupId, trailingSpaceGroupId);
    let body = [];
    if ((0, ast_1.isBranchedTag)(node)) {
        body = cleanDoc(path.map((p) => print(p, {
            leadingSpaceGroupId: tagGroupId,
            trailingSpaceGroupId: tagGroupId,
        }), 'children'));
        if (node.name === 'case')
            body = indent(body);
    }
    else if (node.children.length > 0) {
        body = indent([
            innerLeadingWhitespace(node),
            (0, children_1.printChildren)(path, options, print, {
                leadingSpaceGroupId: tagGroupId,
                trailingSpaceGroupId: tagGroupId,
            }),
        ]);
    }
    return group([blockStart, body, innerTrailingWhitespace(node), blockEnd], {
        id: tagGroupId,
        shouldBreak: LIQUID_TAGS_THAT_ALWAYS_BREAK.includes(node.name) ||
            (0, utils_2.originallyHadLineBreaks)(path, options) ||
            isAttributeNode(node) ||
            (0, utils_2.isDeeplyNested)(node),
    });
}
exports.printLiquidTag = printLiquidTag;
function isAttributeNode(node) {
    return ((0, utils_2.isHtmlNode)(node.parentNode) &&
        node.parentNode.attributes.indexOf(node) !== -1);
}
function innerLeadingWhitespace(node) {
    if (!node.firstChild) {
        if (node.isDanglingWhitespaceSensitive && node.hasDanglingWhitespace) {
            return line;
        }
        else {
            return '';
        }
    }
    if (node.firstChild.hasLeadingWhitespace &&
        node.firstChild.isLeadingWhitespaceSensitive) {
        return line;
    }
    return softline;
}
function innerTrailingWhitespace(node) {
    if (node.type === types_1.NodeTypes.LiquidBranch ||
        !node.blockEndPosition ||
        !node.lastChild) {
        return '';
    }
    if (node.lastChild.hasTrailingWhitespace &&
        node.lastChild.isTrailingWhitespaceSensitive) {
        return line;
    }
    return softline;
}
function printLiquidDefaultBranch(path, options, print, args) {
    const branch = path.getValue();
    const parentNode = path.getParentNode();
    const shouldCollapseSpace = (0, utils_2.isEmpty)(branch.children) && parentNode.children.length === 1;
    if (shouldCollapseSpace)
        return '';
    const isBranchEmptyWithoutSpace = (0, utils_2.isEmpty)(branch.children) && !branch.hasDanglingWhitespace;
    if (isBranchEmptyWithoutSpace)
        return '';
    if (branch.hasDanglingWhitespace) {
        return ifBreak('', ' ');
    }
    return indent([
        innerLeadingWhitespace(parentNode),
        (0, children_1.printChildren)(path, options, print, args),
    ]);
}
function printLiquidBranch(path, options, print, args) {
    const branch = path.getValue();
    const isDefaultBranch = !branch.name;
    if (isDefaultBranch) {
        return printLiquidDefaultBranch(path, options, print, args);
    }
    const leftSibling = branch.prev;
    const shouldCollapseSpace = leftSibling && (0, utils_2.isEmpty)(leftSibling.children);
    const outerLeadingWhitespace = branch.hasLeadingWhitespace && !shouldCollapseSpace ? line : softline;
    return [
        outerLeadingWhitespace,
        printLiquidBlockStart(path, args.leadingSpaceGroupId, args.trailingSpaceGroupId),
        indent([
            innerLeadingWhitespace(branch),
            (0, children_1.printChildren)(path, options, print, args),
        ]),
    ];
}
exports.printLiquidBranch = printLiquidBranch;
function needsBlockStartLeadingWhitespaceStrippingOnBreak(node) {
    switch (node.type) {
        case types_1.NodeTypes.LiquidTag: {
            return (!isAttributeNode(node) && (0, utils_2.hasMeaningfulLackOfLeadingWhitespace)(node));
        }
        case types_1.NodeTypes.LiquidBranch: {
            return (!isAttributeNode(node.parentNode) &&
                (0, utils_2.hasMeaningfulLackOfLeadingWhitespace)(node));
        }
        default: {
            return (0, utils_1.assertNever)(node);
        }
    }
}
function needsBlockStartTrailingWhitespaceStrippingOnBreak(node) {
    switch (node.type) {
        case types_1.NodeTypes.LiquidTag: {
            if ((0, ast_1.isBranchedTag)(node)) {
                return needsBlockStartLeadingWhitespaceStrippingOnBreak(node.firstChild);
            }
            if (!node.children) {
                return (0, utils_2.hasMeaningfulLackOfTrailingWhitespace)(node);
            }
            return (0, utils_2.isEmpty)(node.children)
                ? (0, utils_2.hasMeaningfulLackOfDanglingWhitespace)(node)
                : (0, utils_2.hasMeaningfulLackOfLeadingWhitespace)(node.firstChild);
        }
        case types_1.NodeTypes.LiquidBranch: {
            if (isAttributeNode(node.parentNode)) {
                return false;
            }
            return node.firstChild
                ? (0, utils_2.hasMeaningfulLackOfLeadingWhitespace)(node.firstChild)
                : (0, utils_2.hasMeaningfulLackOfDanglingWhitespace)(node);
        }
        default: {
            return (0, utils_1.assertNever)(node);
        }
    }
}
function needsBlockEndLeadingWhitespaceStrippingOnBreak(node) {
    if (!node.children) {
        throw new Error('Should only call needsBlockEndLeadingWhitespaceStrippingOnBreak for tags that have closing tags');
    }
    else if (isAttributeNode(node)) {
        return false;
    }
    else if ((0, ast_1.isBranchedTag)(node)) {
        return (0, utils_2.hasMeaningfulLackOfTrailingWhitespace)(node.lastChild);
    }
    else if ((0, utils_2.isEmpty)(node.children)) {
        return (0, utils_2.hasMeaningfulLackOfDanglingWhitespace)(node);
    }
    else {
        return (0, utils_2.hasMeaningfulLackOfTrailingWhitespace)(node.lastChild);
    }
}
function cleanDoc(doc) {
    return doc.filter((x) => x !== '');
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlxdWlkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3ByaW50ZXIvcHJpbnQvbGlxdWlkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLHVDQUE2QztBQUM3QyxtQ0FTaUI7QUFDakIsc0NBQTZDO0FBQzdDLG1DQUFzQztBQUV0QywyQ0FZeUI7QUFFekIsdURBQXlEO0FBRXpELE1BQU0sNkJBQTZCLEdBQUcsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFFdEQsTUFBTSxFQUFFLFFBQVEsRUFBRSxHQUFHLGNBQUcsQ0FBQztBQUN6QixNQUFNLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLEdBQUcsUUFBUSxDQUFDO0FBRTVFLFNBQWdCLGVBQWUsQ0FDN0IsSUFBbUIsRUFDbkIsUUFBNkIsRUFDN0IsS0FBb0IsRUFDcEIsRUFBRSxtQkFBbUIsRUFBRSxvQkFBb0IsRUFBcUI7SUFFaEUsTUFBTSxJQUFJLEdBQWUsSUFBSSxDQUFDLFFBQVEsRUFBZ0IsQ0FBQztJQUN2RCxNQUFNLGVBQWUsR0FBRyxJQUFBLHlCQUFpQixFQUN2QyxJQUFJLENBQUMsZUFBZSxFQUNwQixJQUFBLDRDQUFvQyxFQUFDLElBQUksQ0FBQyxFQUMxQyxtQkFBbUIsQ0FDcEIsQ0FBQztJQUNGLE1BQU0sYUFBYSxHQUFHLElBQUEseUJBQWlCLEVBQ3JDLElBQUksQ0FBQyxhQUFhLEVBQ2xCLElBQUEsNkNBQXFDLEVBQUMsSUFBSSxDQUFDLEVBQzNDLG9CQUFvQixDQUNyQixDQUFDO0lBRUYsSUFBSSxPQUFPLElBQUksQ0FBQyxNQUFNLEtBQUssUUFBUSxFQUFFO1FBQ25DLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMs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